# Repository Guidelines — PRD（产品需求文档草案）

## 1. 背景与目标
你当前的日报管道已能抓取 RSS/Atom → 去重 → 评分/摘要 → 生成 `NewsReport/` + `site/` 静态站，但存在三类核心痛点：**阅读站不够可持续使用**、**更新/发布不自动**、**信息结构与来源偏单一（偏技术）**。本 PRD 目标是把它升级成「每天 9 点自动更新、可持续阅读、内容更均衡（含经济/市场指标）」的个人信息仪表盘。

## 2. 核心用户与使用场景
- 核心用户：你本人（高信息密度需求、反感低信噪源）。
- 场景：
  - 早上 9 点打开站点/手机收藏页，快速扫一遍今日重点。
  - 按主题/平台/关键词回溯近 7/30 天，形成“信息脉络”。

## 3. 产品原则（你的偏好抽象）
- 高质量、不过冷门、低重复：宁可少，也要稳。
- 内容结构更均衡：技术不一家独大，补足经济/市场/公司动向。
- 多端点平台（如 知乎/V2EX）：**全部请求后统一去重**，再按配额截断。
- 英文内容：默认提供中文标题/要点（可选启用 AI）。

## 4. 需求范围
### 4.1 MVP（先把“每天可用”做出来）
1) **自动更新与发布**
- 每天固定时间（默认 09:00，可配置时区）自动运行抓取与生成。
- 自动部署静态站（推荐 GitHub Pages / Cloudflare Pages）。

2) **内容多样性**
- 支持“RSS + 市场数据”混合：至少展示
  - 上证指数（或代表性 A 股指数）
  - 黄金价格（现货/期货二选一）
- 报告顶部提供「今日指标卡片」+ 与昨日/近 7 日简单对比（若可获取历史）。
 - 数据落地：写入 `NewsReport/data/YYYY-MM-DD.json` 的 `meta.market`（包含 `value/change/change_pct/as_of/provider` 等），前端只负责渲染。
 - 信息源治理：以 `my/sources.checklist.md` 为唯一入口（勾选），脚本同步生成启用列表 `my/sources.md`。

3) **可配置性（避免强改代码）**
- 将关键配额/策略参数外置：如 `per_feed_limit`、`per_platform_limit`、`max_items`、`time_budget`、`proxy`、栏目配比等。
 - 支持“按平台单独限额”（例如 HelloGitHub 固定只保留 1 条）。

### 4.2 vNext（让“站点好玩”与可扩展）
- 前端升级为 Vue 3（建议 Vite）+ 组件化信息卡片。
- 站点能力：多维筛选、收藏/稍后读、热词与趋势（近 7 天）、分享/复制 Markdown。
- “源管理”可视化：在站内管理并落盘到 `my/sources.checklist.md`（再同步生成 `my/sources.md`）。

## 5. 功能需求（验收口径）
1) **定时任务**
- 09:00（目标时区）后 5 分钟内，站点可看到当日数据已更新（含更新时间戳）。

2) **自动部署**
- 无需手工提交产物；流水线成功后自动发布到固定 URL。
- 失败可追踪：在日志中明确指出失败源/失败原因（超时、非 XML、解析错误等）。

3) **市场数据**
- 页面顶部展示指数与黄金的最新值、涨跌幅（若可得）。
- 数据源可替换（同一指标支持多供应商 fallback），避免单点失效。

4) **内容配比**
- 可配置“栏目配比/上限”，例如：技术 40%、经济/市场 30%、产品/管理 20%、其他 10%（示例）。
- 去重策略对跨源转载要有效（同标题/同链接/近似标题）。

## 6. 数据源与合规/稳定性说明（必须提前定）
- RSS/Atom：优先官方源；RSSHub/第三方聚合源作为补充但需标记“易失效”。
- 市场数据：参考 `LeekHub/leek-fund` 的实现与可用数据源，选择**允许个人使用且稳定的公开接口**；若不可避免使用第三方抓取，需加缓存与限频，并预留替换接口层。

## 7. 技术方案建议（实现路径）
- 后端生成：继续用现有 Python 脚本输出 `NewsReport/data/YYYY-MM-DD.json` + `site/assets/data.js`。
- 自动化：使用 CI 定时（GitHub Actions `schedule` / Pages 部署），并将时区作为配置项处理（cron 为 UTC，需要换算）。
- 前端：新增 `web/`（Vue3）构建后输出到 `site/` 或独立 `dist/`，与生成数据解耦。

## 8. 风险与待澄清问题（你 review 时请重点确认）
已确认：
1) “每天 9 点”以中国时区（Asia/Shanghai）为准。
2) 市场数据参考 `LeekHub/leek-fund`。
3) 暂不要求离线可用（可接受在线站点/接口请求）。
4) 英文翻译需求先忽略（后续再加）。

## 9. 当前执行策略（你已指定）
- 先做 MVP：只在本地开发与验证（暂不绑定站点域名/托管平台）。
- 同步维护 `PRD.md` 与 `TODO.md`，便于后续滚动迭代需求与范围。
